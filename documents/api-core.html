<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Core API Reference - Ownaudio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="docs.css">
</head>
<body>
    <nav class="nav">
        <div class="nav-container">
            <a href="../index.html" class="logo">OwnaudioSharp</a>
            <ul class="nav-links">
                <li><a href="quickstart.html">Quick Start</a></li>
                <li><a href="api-core.html" class="active">Core API</a></li>
                <li><a href="api-net.html">NET API</a></li>
                <li><a href="examples.html">Examples</a></li>
				<li><a href="matchering.html">Matchering</a></li>
                <li><a href="chorddetect.html">Chord Detection</a></li>
                <li><a href="https://github.com/ModernMube/OwnAudioSharp" target="_blank">GitHub</a></li>
            </ul>
        </div>
    </nav>

    <div class="main">
        <aside class="sidebar">
            <h3>Core API</h3>
            <ul class="sidebar-nav">
                <li><a href="#overview" class="active">Overview</a></li>
                <li><a href="#interfaces">Interfaces</a></li>
                <li><a href="#factories">Factories</a></li>
                <li><a href="#classes">Classes</a></li>
                <li><a href="#enums">Enumerations</a></li>
                <li><a href="#common">Common Components</a></li>
                <li><a href="#performance">Performance</a></li>
            </ul>
        </aside>

        <main class="content">
            <h1><span class="badge badge-core">Core</span> Ownaudio.Core API Reference</h1>
            <p>
                Low-level cross-platform audio engine with zero-allocation guarantee and real-time safety.
                Built on pure managed code without external dependencies.
            </p>

            <div class="alert alert-info">
                <strong>Zero External Dependencies</strong>
                Ownaudio.Core uses native system audio APIs directly: WASAPI (Windows), Core Audio (macOS/iOS), 
                PulseAudio (Linux), and Oboe (Android). No additional libraries required!
            </div>

            <h2 id="overview">Overview</h2>
            <p>
                Ownaudio.Core provides the foundation for cross-platform audio applications with:
            </p>
            <ul>
                <li><strong>Zero-allocation guarantee</strong> in real-time audio paths</li>
                <li><strong>Platform-native APIs</strong> for optimal performance</li>
                <li><strong>Built-in decoders</strong> for WAV, MP3, and FLAC</li>
                <li><strong>Device management</strong> with hot-plug support</li>
                <li><strong>Automatic format conversion</strong> and resampling</li>
            </ul>

            <h3>Supported Platforms</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Platform</th>
                        <th>Native API</th>
                        <th>Assembly</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Windows</td>
                        <td>WASAPI</td>
                        <td>Ownaudio.Windows</td>
                    </tr>
                    <tr>
                        <td>macOS</td>
                        <td>Core Audio</td>
                        <td>Ownaudio.macOS</td>
                    </tr>
                    <tr>
                        <td>Linux</td>
                        <td>PulseAudio</td>
                        <td>Ownaudio.Linux</td>
                    </tr>
                    <tr>
                        <td>iOS</td>
                        <td>Core Audio</td>
                        <td>Ownaudio.iOS - In Progress...</td>
                    </tr>
                    <tr>
                        <td>Android</td>
                        <td>Oboe</td>
                        <td>Ownaudio.Android - In Progress...</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="interfaces">Interfaces</h2>

            <h3>IAudioEngine</h3>
            <p>Platform-independent audio engine interface for real-time playback and recording.</p>

            <div class="code-block">
                <div class="code-header">IAudioEngine Interface</div>
                <pre><code class="language-csharp">public interface IAudioEngine
{
    // Properties
    int FramesPerBuffer { get; }
    
    // Lifecycle Methods
    int Initialize(AudioConfig config);
    int Start();
    int Stop();
    int OwnAudioEngineActivate();
    int OwnAudioEngineStopped();
    
    // Audio I/O
    void Send(Span&lt;float&gt; samples);
    int Receives(out float[] samples);
    IntPtr GetStream();
    
    // Device Management
    List&lt;AudioDeviceInfo&gt; GetOutputDevices();
    List&lt;AudioDeviceInfo&gt; GetInputDevices();
    int SetOutputDeviceByName(string deviceName);
    int SetOutputDeviceByIndex(int deviceIndex);
    int SetInputDeviceByName(string deviceName);
    int SetInputDeviceByIndex(int deviceIndex);
    
    // Events
    event EventHandler&lt;AudioDeviceChangedEventArgs&gt; OutputDeviceChanged;
    event EventHandler&lt;AudioDeviceChangedEventArgs&gt; InputDeviceChanged;
    event EventHandler&lt;AudioDeviceStateChangedEventArgs&gt; DeviceStateChanged;
}</code></pre>
            </div>

            <h4>Properties</h4>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>FramesPerBuffer</code></td>
                        <td>int</td>
                        <td>Actual buffer size in frames (may differ from requested)</td>
                    </tr>
                </tbody>
            </table>

            <h4>Methods</h4>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Return</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Initialize(AudioConfig)</code></td>
                        <td>int</td>
                        <td>Initialize engine. Returns 0 on success, negative on error</td>
                    </tr>
                    <tr>
                        <td><code>Start()</code></td>
                        <td>int</td>
                        <td>Start audio engine (thread-safe, idempotent)</td>
                    </tr>
                    <tr>
                        <td><code>Stop()</code></td>
                        <td>int</td>
                        <td>Stop audio engine (thread-safe, idempotent)</td>
                    </tr>
                    <tr>
                        <td><code>Send(Span&lt;float&gt;)</code></td>
                        <td>void</td>
                        <td>Send audio samples (blocking, zero-allocation)</td>
                    </tr>
                    <tr>
                        <td><code>Receives(out float[])</code></td>
                        <td>int</td>
                        <td>Receive audio samples (pooled buffer). Returns sample count</td>
                    </tr>
                    <tr>
                        <td><code>GetOutputDevices()</code></td>
                        <td>List</td>
                        <td>Get list of available output devices</td>
                    </tr>
                    <tr>
                        <td><code>GetInputDevices()</code></td>
                        <td>List</td>
                        <td>Get list of available input devices</td>
                    </tr>
                </tbody>
            </table>

            <h4>Usage Example</h4>
            <div class="code-block">
                <div class="code-header">Basic Engine Usage</div>
                <pre><code class="language-csharp">// Create and initialize engine
using var engine = AudioEngineFactory.CreateDefault();
engine.Initialize(AudioConfig.Default);

// Start the engine
engine.Start();

// Send audio samples
float[] samples = GenerateAudio();
engine.Send(samples.AsSpan());

// Stop the engine
engine.Stop();</code></pre>
            </div>

            <h3>IAudioDecoder</h3>
            <p>Audio file decoder interface for WAV, MP3, and FLAC formats.</p>

            <div class="code-block">
                <div class="code-header">IAudioDecoder Interface</div>
                <pre><code class="language-csharp">public interface IAudioDecoder : IDisposable
{
    AudioStreamInfo StreamInfo { get; }
    
    AudioDecoderResult DecodeNextFrame();
    bool TrySeek(TimeSpan position, out string error);
    AudioDecoderResult DecodeAllFrames(TimeSpan position);
}</code></pre>
            </div>

            <h4>Properties</h4>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>StreamInfo</code></td>
                        <td>AudioStreamInfo</td>
                        <td>Information about the loaded audio stream</td>
                    </tr>
                </tbody>
            </table>

            <h4>Methods</h4>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Return</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>DecodeNextFrame()</code></td>
                        <td>AudioDecoderResult</td>
                        <td>Decode next audio frame</td>
                    </tr>
                    <tr>
                        <td><code>TrySeek(TimeSpan, out string)</code></td>
                        <td>bool</td>
                        <td>Seek to position. Returns true on success</td>
                    </tr>
                    <tr>
                        <td><code>DecodeAllFrames(TimeSpan)</code></td>
                        <td>AudioDecoderResult</td>
                        <td>Decode all frames from position</td>
                    </tr>
                </tbody>
            </table>

            <h4>Usage Example</h4>
            <div class="code-block">
                <div class="code-header">Decoder Usage</div>
                <pre><code class="language-csharp">// Create decoder
using var decoder = AudioDecoderFactory.Create(
    "music.mp3",
    targetSampleRate: 48000,
    targetChannels: 2
);

// Get stream info
var info = decoder.StreamInfo;
Console.WriteLine($"Duration: {info.Duration}");

// Decode frames
while (true)
{
    var result = decoder.DecodeNextFrame();
    if (result.IsEOF) break;
    
    // Process frame
    ProcessAudioFrame(result.Frame);
}

// Seek to position
if (decoder.TrySeek(TimeSpan.FromSeconds(30), out string error))
{
    Console.WriteLine("Seeked to 30 seconds");
}</code></pre>
            </div>

            <h2 id="factories">Factory Classes</h2>

            <h3>AudioEngineFactory</h3>
            <p>Creates platform-specific audio engine instances.</p>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Create(AudioConfig)</code></td>
                        <td>Create engine with custom configuration</td>
                    </tr>
                    <tr>
                        <td><code>CreateDefault()</code></td>
                        <td>Create with default settings (48kHz, stereo, 512 frames)</td>
                    </tr>
                    <tr>
                        <td><code>CreateLowLatency()</code></td>
                        <td>Create with low latency settings (128 frames)</td>
                    </tr>
                    <tr>
                        <td><code>CreateHighLatency()</code></td>
                        <td>Create with high latency settings (2048 frames)</td>
                    </tr>
                    <tr>
                        <td><code>GetPlatformInfo()</code></td>
                        <td>Get current platform information string</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block">
                <div class="code-header">Factory Usage</div>
                <pre><code class="language-csharp">// Default configuration
using var engine1 = AudioEngineFactory.CreateDefault();

// Low latency
using var engine2 = AudioEngineFactory.CreateLowLatency();

// Custom configuration
var config = new AudioConfig
{
    SampleRate = 44100,
    Channels = 2,
    BufferSize = 256
};
using var engine3 = AudioEngineFactory.Create(config);

// Platform info
string platform = AudioEngineFactory.GetPlatformInfo();
Console.WriteLine($"Platform: {platform}"); // e.g., "Windows-WASAPI"</code></pre>
            </div>

            <h3>AudioDecoderFactory</h3>
            <p>Creates audio decoders based on file format.</p>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Create(string, int, int)</code></td>
                        <td>Create decoder from file path with target sample rate and channels</td>
                    </tr>
                    <tr>
                        <td><code>Create(Stream, AudioFormat, int, int)</code></td>
                        <td>Create decoder from stream with specified format</td>
                    </tr>
                </tbody>
            </table>

            <h4>Supported Formats</h4>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Format</th>
                        <th>Types</th>
                        <th>Implementation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>WAV</td>
                        <td>PCM, IEEE Float, ADPCM</td>
                        <td>Pure C# implementation</td>
                    </tr>
                    <tr>
                        <td>MP3</td>
                        <td>MPEG-1/2 Layer III</td>
                        <td>Platform-specific or managed fallback</td>
                    </tr>
                    <tr>
                        <td>FLAC</td>
                        <td>Free Lossless Audio Codec</td>
                        <td>Pure C# managed implementation</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block">
                <div class="code-header">Decoder Factory Usage</div>
                <pre><code class="language-csharp">// From file path (auto-detect format)
using var decoder1 = AudioDecoderFactory.Create(
    "music.mp3",
    targetSampleRate: 48000,
    targetChannels: 2
);

// From stream with explicit format
using var stream = File.OpenRead("audio.wav");
using var decoder2 = AudioDecoderFactory.Create(
    stream,
    AudioFormat.Wav,
    targetSampleRate: 48000,
    targetChannels: 2
);</code></pre>
            </div>

            <h2 id="classes">Configuration Classes</h2>

            <h3>AudioConfig</h3>
            <p>Audio engine configuration parameters.</p>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Default</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>SampleRate</code></td>
                        <td>int</td>
                        <td>48000</td>
                        <td>Sample rate in Hz (typical: 44100, 48000, 96000)</td>
                    </tr>
                    <tr>
                        <td><code>Channels</code></td>
                        <td>int</td>
                        <td>2</td>
                        <td>Number of channels (1=mono, 2=stereo)</td>
                    </tr>
                    <tr>
                        <td><code>BufferSize</code></td>
                        <td>int</td>
                        <td>512</td>
                        <td>Buffer size in frames (affects latency)</td>
                    </tr>
                    <tr>
                        <td><code>EnableInput</code></td>
                        <td>bool</td>
                        <td>false</td>
                        <td>Enable audio input/recording</td>
                    </tr>
                    <tr>
                        <td><code>EnableOutput</code></td>
                        <td>bool</td>
                        <td>true</td>
                        <td>Enable audio output/playback</td>
                    </tr>
                    <tr>
                        <td><code>OutputDeviceId</code></td>
                        <td>string?</td>
                        <td>null</td>
                        <td>Specific output device ID (null for default)</td>
                    </tr>
                    <tr>
                        <td><code>InputDeviceId</code></td>
                        <td>string?</td>
                        <td>null</td>
                        <td>Specific input device ID (null for default)</td>
                    </tr>
                </tbody>
            </table>

            <h4>Predefined Configurations</h4>
            <ul>
                <li><code>AudioConfig.Default</code> - 48kHz, stereo, 512 frames (~10ms latency)</li>
                <li><code>AudioConfig.LowLatency</code> - 48kHz, stereo, 128 frames (~2.7ms latency)</li>
                <li><code>AudioConfig.HighLatency</code> - 48kHz, stereo, 2048 frames (~42ms latency)</li>
            </ul>

            <div class="code-block">
                <div class="code-header">Configuration Example</div>
                <pre><code class="language-csharp">// Use predefined config
var config1 = AudioConfig.Default;

// Custom configuration
var config2 = new AudioConfig
{
    SampleRate = 44100,
    Channels = 1,           // Mono
    BufferSize = 256,       // Low latency
    EnableInput = true,
    EnableOutput = true
};

// Validate configuration
if (config2.Validate())
{
    Console.WriteLine("Configuration is valid");
}</code></pre>
            </div>

            <h3>AudioDeviceInfo</h3>
            <p>Information about an audio device.</p>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>DeviceId</code></td>
                        <td>string</td>
                        <td>Unique device identifier</td>
                    </tr>
                    <tr>
                        <td><code>Name</code></td>
                        <td>string</td>
                        <td>Human-readable device name</td>
                    </tr>
                    <tr>
                        <td><code>IsInput</code></td>
                        <td>bool</td>
                        <td>True if device supports input</td>
                    </tr>
                    <tr>
                        <td><code>IsOutput</code></td>
                        <td>bool</td>
                        <td>True if device supports output</td>
                    </tr>
                    <tr>
                        <td><code>IsDefault</code></td>
                        <td>bool</td>
                        <td>True if this is the default device</td>
                    </tr>
                    <tr>
                        <td><code>State</code></td>
                        <td>AudioDeviceState</td>
                        <td>Current device state</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block">
                <div class="code-header">Device Enumeration</div>
                <pre><code class="language-csharp">using var engine = AudioEngineFactory.CreateDefault();
engine.Initialize(AudioConfig.Default);

// List output devices
var devices = engine.GetOutputDevices();
foreach (var device in devices)
{
    Console.WriteLine($"Device: {device.Name}");
    Console.WriteLine($"  ID: {device.DeviceId}");
    Console.WriteLine($"  Default: {device.IsDefault}");
    Console.WriteLine($"  State: {device.State}");
}</code></pre>
            </div>

            <h3>AudioStreamInfo</h3>
            <p>Information about an audio stream.</p>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>SampleRate</code></td>
                        <td>int</td>
                        <td>Sample rate in Hz</td>
                    </tr>
                    <tr>
                        <td><code>Channels</code></td>
                        <td>int</td>
                        <td>Number of channels</td>
                    </tr>
                    <tr>
                        <td><code>Duration</code></td>
                        <td>TimeSpan</td>
                        <td>Total duration of the stream</td>
                    </tr>
                    <tr>
                        <td><code>TotalFrames</code></td>
                        <td>long</td>
                        <td>Total number of frames</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="enums">Enumerations</h2>

            <h3>AudioDeviceState</h3>
            <p>Possible states of an audio device.</p>

            <div class="code-block">
                <div class="code-header">AudioDeviceState Enum</div>
                <pre><code class="language-csharp">[Flags]
public enum AudioDeviceState
{
    Active      = 0x00000001,  // Device is active and available
    Disabled    = 0x00000002,  // Device is disabled
    NotPresent  = 0x00000004,  // Device is not present
    Unplugged   = 0x00000008,  // Device is unplugged
    All         = 0x0000000F   // All device states
}</code></pre>
            </div>

            <h3>AudioFormat</h3>
            <p>Supported audio file formats.</p>

            <div class="code-block">
                <div class="code-header">AudioFormat Enum</div>
                <pre><code class="language-csharp">public enum AudioFormat
{
    Unknown,  // Unknown format
    Wav,      // WAV format (PCM, IEEE Float, ADPCM)
    Mp3,      // MP3 format (MPEG-1/2/2.5 Layer III)
    Flac      // FLAC format (Free Lossless Audio Codec)
}</code></pre>
            </div>

            <h2 id="common">Common Components</h2>

            <p>The <code>Ownaudio.Core.Common</code> namespace provides utility classes for audio processing:</p>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Class</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>AudioBuffer</code></td>
                        <td>Efficient audio buffer management</td>
                    </tr>
                    <tr>
                        <td><code>AudioChannelConverter</code></td>
                        <td>Channel conversion (mono/stereo)</td>
                    </tr>
                    <tr>
                        <td><code>AudioResampler</code></td>
                        <td>Sample rate conversion</td>
                    </tr>
                    <tr>
                        <td><code>AudioFormatConverter</code></td>
                        <td>Format conversion utilities</td>
                    </tr>
                    <tr>
                        <td><code>LockFreeRingBuffer</code></td>
                        <td>Lock-free circular buffer for real-time audio</td>
                    </tr>
                    <tr>
                        <td><code>AudioFramePool</code></td>
                        <td>Object pool for audio frames</td>
                    </tr>
                    <tr>
                        <td><code>SimdAudioConverter</code></td>
                        <td>SIMD-optimized audio conversion</td>
                    </tr>
                    <tr>
                        <td><code>DecodedAudioCache</code></td>
                        <td>Cache for decoded audio data</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="performance">Performance Characteristics</h2>

            <h3>Zero-Allocation Guarantee</h3>
            <p>
                Critical audio paths use zero-allocation techniques:
            </p>
            <ul>
                <li><code>Send(Span&lt;float&gt;)</code> - No allocations in audio callback</li>
                <li><code>Receives(out float[])</code> - Uses pooled buffers</li>
                <li>Lock-free data structures for thread synchronization</li>
                <li>Object pooling for frequently allocated objects</li>
            </ul>

            <h3>Latency</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Buffer Size</th>
                        <th>Latency @ 48kHz</th>
                        <th>Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>128 frames</td>
                        <td>~2.7 ms</td>
                        <td>Professional audio, live monitoring</td>
                    </tr>
                    <tr>
                        <td>256 frames</td>
                        <td>~5.3 ms</td>
                        <td>Low latency applications</td>
                    </tr>
                    <tr>
                        <td>512 frames</td>
                        <td>~10.7 ms</td>
                        <td>Default, balanced performance</td>
                    </tr>
                    <tr>
                        <td>1024 frames</td>
                        <td>~21.3 ms</td>
                        <td>Standard applications</td>
                    </tr>
                    <tr>
                        <td>2048 frames</td>
                        <td>~42.7 ms</td>
                        <td>High reliability, less CPU usage</td>
                    </tr>
                </tbody>
            </table>

            <h3>CPU Usage</h3>
            <ul>
                <li><strong>Idle:</strong> &lt; 1%</li>
                <li><strong>Active playback:</strong> ~2-3% (single stream)</li>
                <li><strong>SIMD optimizations:</strong> Available on supported platforms</li>
                <li><strong>Thread priority:</strong> Real-time priority for audio callback</li>
            </ul>

            <h3>Memory</h3>
            <ul>
                <li>Minimal allocations in real-time paths</li>
                <li>Object pooling for frequently used objects</li>
                <li>Efficient buffer management</li>
                <li>Platform-specific optimizations</li>
            </ul>

            <div class="alert alert-info">
                <strong>Thread Safety</strong>
                All public APIs are thread-safe. Internal audio processing uses lock-free data structures
                for real-time performance.
            </div>

            <div style="margin-top: 4rem; padding: 2rem; background: var(--surface); border-radius: 8px;">
                <h3>Related Documentation</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.5rem;">
                        <a href="quickstart.html" style="color: var(--primary-color);">üìñ Quick Start Guide</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="api-net.html" style="color: var(--net-color);">üéõÔ∏è NET API Reference</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="examples.html" style="color: var(--primary-color);">üí° Code Examples</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="https://github.com/ModernMube/OwnAudioSharp" target="_blank" style="color: var(--primary-color);">üîó GitHub Repository</a>
                    </li>
                </ul>
            </div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Active sidebar navigation
        const sections = document.querySelectorAll('h2[id], h3[id]');
        const navLinks = document.querySelectorAll('.sidebar-nav a');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (window.pageYOffset >= sectionTop - 150) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
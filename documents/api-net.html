<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NET API Reference - Ownaudio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="docs.css">
</head>

<body>
    <nav class="nav">
        <div class="nav-container">
            <a href="../index.html" class="logo">OwnaudioSharp</a>
            <ul class="nav-links">
                <li><a href="quickstart.html">Quick Start</a></li>
                <li><a href="api-core.html">Core API</a></li>
                <li><a href="api-net.html" class="active">NET API</a></li>
                <li><a href="examples.html">Examples</a></li>
                <li><a href="effects.html">Effects</a></li>
                <li><a href="networksync.html">Net Sync</a></li>
                <li><a href="matchering.html">Mastering</a></li>
                <li><a href="vocalremover.html">Vocal Sep</a></li>
                <li><a href="chorddetect.html">Chords</a></li>
                <li><a href="https://github.com/ModernMube/OwnAudioSharp" target="_blank">GitHub</a></li>
            </ul>
        </div>
    </nav>

    <div class="main">
        <aside class="sidebar">
            <h3>NET API</h3>
            <ul class="sidebar-nav">
                <li><a href="#overview" class="active">Overview</a></li>
                <li><a href="#initialization">Initialization</a></li>
                <li><a href="#sources">Audio Sources</a></li>
                <li><a href="#mixer">AudioMixer</a></li>
                <li><a href="#effects">Effects</a></li>
                <li><a href="#sync">Synchronization</a></li>
            </ul>
        </aside>

        <main class="content">
            <h1><span class="badge badge-net">NET</span> OwnaudioNET API Reference</h1>
            <p>
                High-level audio API with professional features including multi-track mixing, effects processing,
                synchronization, and real-time audio manipulation.
            </p>

            <div class="alert alert-info">
                <strong>Production-Ready Features</strong>
                OwnaudioNET provides 15+ professional effects, unlimited track mixing, Master Clock synchronization,
                tempo/pitch control, and recording capabilities.
            </div>

            <h2 id="overview">Overview</h2>
            <p>OwnaudioNET extends Ownaudio.Core with high-level features:</p>
            <ul>
                <li><strong>Multi-track mixing</strong> - Unlimited simultaneous audio sources</li>
                <li><strong>15+ professional effects</strong> - Reverb, compressor, EQ, and more</li>
                <li><strong>Master Clock synchronization</strong> - Sample-accurate timeline-based sync with drift
                    correction</li>
                <li><strong>DAW-style features</strong> - Realtime/offline rendering modes, start offsets</li>
                <li><strong>Tempo and pitch control</strong> - Independent time-stretch and pitch-shift via SoundTouch
                </li>
                <li><strong>Recording</strong> - Mix-down to WAV format</li>
                <li><strong>Real-time metering</strong> - Peak and RMS level monitoring</li>
                <li><strong>Thread-safe architecture</strong> - Lock-free buffers for glitch-free audio</li>
            </ul>

            <h2 id="initialization">Initialization</h2>

            <h3>OwnaudioNet Class</h3>
            <p>Central initialization and configuration for OwnaudioNET.</p>

            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è UI APPLICATIONS: Use Async API</strong>
                For desktop/mobile UI applications, use async methods to prevent UI thread blocking:
                <ul>
                    <li><code>await InitializeAsync()</code> - Prevents 50-5000ms UI freeze</li>
                    <li><code>await StopAsync()</code> - Prevents up to 2000ms UI freeze</li>
                    <li><code>await ShutdownAsync()</code> - Non-blocking shutdown</li>
                    <li><code>await GetOutputDevicesAsync()</code> - Non-blocking device enumeration</li>
                </ul>
            </div>

            <div class="code-block">
                <div class="code-header">Synchronous Initialization (Console Apps)</div>
                <pre><code class="language-csharp">// Default initialization (48kHz, stereo, 512 frames)
OwnaudioNet.Initialize();

// Custom configuration
var config = new AudioConfig
{
    SampleRate = 44100,
    Channels = 2,
    BufferSize = 256
};
OwnaudioNet.Initialize(config);

// Shutdown
OwnaudioNet.Shutdown();</code></pre>
            </div>

            <div class="code-block">
                <div class="code-header">Async Initialization (UI Apps) ‚≠ê RECOMMENDED</div>
                <pre><code class="language-csharp">// Default async initialization
await OwnaudioNet.InitializeAsync();

// Custom async configuration
var config = new AudioConfig
{
    SampleRate = 44100,
    Channels = 2,
    BufferSize = 256
};
await OwnaudioNet.InitializeAsync(config);

// Async device enumeration
var devices = await OwnaudioNet.GetOutputDevicesAsync();
foreach (var device in devices)
{
    Console.WriteLine($"Device: {device.Name}");
}

// Async shutdown
await OwnaudioNet.ShutdownAsync();</code></pre>
            </div>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                        <th>Recommended For</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Initialize()</code></td>
                        <td>Initialize with default settings (‚ö†Ô∏è BLOCKS 50-200ms)</td>
                        <td>Console apps</td>
                    </tr>
                    <tr>
                        <td><code>Initialize(AudioConfig)</code></td>
                        <td>Initialize with custom config (‚ö†Ô∏è BLOCKS 50-5000ms)</td>
                        <td>Console apps</td>
                    </tr>
                    <tr>
                        <td><code>InitializeAsync()</code></td>
                        <td>‚úÖ Async init with default settings (NON-BLOCKING)</td>
                        <td>UI apps (WPF, MAUI, Avalonia)</td>
                    </tr>
                    <tr>
                        <td><code>InitializeAsync(AudioConfig)</code></td>
                        <td>‚úÖ Async init with custom config (NON-BLOCKING)</td>
                        <td>UI apps (WPF, MAUI, Avalonia)</td>
                    </tr>
                    <tr>
                        <td><code>Shutdown()</code></td>
                        <td>Shutdown and release resources (‚ö†Ô∏è BLOCKS up to 2000ms)</td>
                        <td>Console apps</td>
                    </tr>
                    <tr>
                        <td><code>ShutdownAsync()</code></td>
                        <td>‚úÖ Async shutdown (NON-BLOCKING)</td>
                        <td>UI apps (WPF, MAUI, Avalonia)</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="sources">Audio Sources</h2>

            <h3>FileSource</h3>
            <p>File-based audio source with decoding, SoundTouch support, and Master Clock synchronization.</p>

            <div class="code-block">
                <div class="code-header">FileSource Usage</div>
                <pre><code class="language-csharp">// Create from file
var source = new FileSource("music.mp3");

// Configure playback
source.Volume = 0.8f;          // Volume (0.0-1.0)
source.Loop = true;             // Enable looping
source.Tempo = 1.2f;            // 20% faster (0.8-1.2)
source.PitchShift = -2.0f;      // 2 semitones lower (-12..+12)

// Control playback
source.Play();
source.Pause();
source.Stop();
source.Seek(30.0);  // Seek to 30 seconds

// Get info
double position = source.Position;  // Current position (seconds)
double duration = source.Duration;  // Total duration (seconds)
AudioState state = source.State;    // Playing/Paused/Stopped

// Cleanup
source.Dispose();</code></pre>
            </div>

            <h4>Properties</h4>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Id</code></td>
                        <td>Guid</td>
                        <td>Unique source identifier</td>
                    </tr>
                    <tr>
                        <td><code>State</code></td>
                        <td>AudioState</td>
                        <td>Current playback state</td>
                    </tr>
                    <tr>
                        <td><code>Volume</code></td>
                        <td>float</td>
                        <td>Volume level (0.0-1.0)</td>
                    </tr>
                    <tr>
                        <td><code>Loop</code></td>
                        <td>bool</td>
                        <td>Enable/disable looping</td>
                    </tr>
                    <tr>
                        <td><code>Position</code></td>
                        <td>double</td>
                        <td>Current position in seconds</td>
                    </tr>
                    <tr>
                        <td><code>Duration</code></td>
                        <td>double</td>
                        <td>Total duration in seconds</td>
                    </tr>
                    <tr>
                        <td><code>Tempo</code></td>
                        <td>float</td>
                        <td>Playback tempo (0.8-1.2, 1.0 = normal)</td>
                    </tr>
                    <tr>
                        <td><code>PitchShift</code></td>
                        <td>float</td>
                        <td>Pitch shift in semitones (-12..+12)</td>
                    </tr>
                    <tr>
                        <td><code>StartOffset</code></td>
                        <td>double</td>
                        <td>Timeline start position (for Master Clock sync)</td>
                    </tr>
                </tbody>
            </table>

            <h3>SampleSource</h3>
            <p>Play audio from memory samples with optional dynamic updates.</p>

            <div class="code-block">
                <div class="code-header">SampleSource Usage</div>
                <pre><code class="language-csharp">// Generate or load samples
float[] samples = GenerateAudioSamples();

// Create source from existing samples
var config = new AudioConfig
{
    SampleRate = 48000,
    Channels = 2
};
var source = new SampleSource(samples, config);

// OR create empty source for dynamic updates
var dynamicSource = new SampleSource(
    bufferSizeInFrames: 48000,  // 1 second buffer
    config: config
);

// Update samples dynamically
float[] newSamples = GenerateNewSamples();
dynamicSource.SubmitSamples(newSamples);

// Playback control
source.Play();
source.Loop = true;</code></pre>
            </div>

            <h3>InputSource</h3>
            <p>Real-time audio input from microphone or line-in.</p>

            <div class="code-block">
                <div class="code-header">InputSource Usage</div>
                <pre><code class="language-csharp">// Initialize OwnaudioNET (engine must be running)
OwnaudioNet.Initialize();

// Create input source
var input = new InputSource(
    engine: OwnaudioNet.Engine,
    bufferSizeInFrames: 8192  // Optional, default is 8192
);

// Add to mixer and start
mixer.AddSource(input);
input.Play();</code></pre>
            </div>

            <h3>SourceWithEffects</h3>
            <p>Wrapper for applying effects chains to any audio source.</p>

            <div class="code-block">
                <div class="code-header">SourceWithEffects Usage</div>
                <pre><code class="language-csharp">var source = new FileSource("guitar.wav");

// Create source with effects wrapper
var sourceWithFx = new SourceWithEffects(source);

// Add effects to the chain
var reverb = new ReverbEffect
{
    Mix = 0.3f,
    RoomSize = 0.7f,
    Damping = 0.5f
};
sourceWithFx.AddEffect(reverb);

var compressor = new CompressorEffect(
    threshold: 0.5f,
    ratio: 4.0f,
    attackTime: 10.0f,
    releaseTime: 100.0f,
    makeupGain: 1.0f,
    sampleRate: 48000f
);
sourceWithFx.AddEffect(compressor);

// Modify effects dynamically
reverb.Enabled = false;  // Bypass effect
sourceWithFx.RemoveEffect(compressor);
sourceWithFx.ClearEffects();</code></pre>
            </div>

            <h2 id="mixer">AudioMixer</h2>
            <p>Central mixing engine for multi-track audio playback with Master Clock synchronization.</p>

            <div class="code-block">
                <div class="code-header">AudioMixer Usage</div>
                <pre><code class="language-csharp">// Create mixer
var mixer = new AudioMixer(OwnaudioNet.Engine);
mixer.Start();

// Add sources
var drums = new FileSource("drums.wav");
var bass = new FileSource("bass.wav");
var guitar = new FileSource("guitar.wav");

mixer.AddSource(drums);
mixer.AddSource(bass);
mixer.AddSource(guitar);

// Control individual sources
drums.Volume = 0.8f;
bass.Volume = 0.7f;
guitar.Volume = 0.6f;

// Play sources
drums.Play();
bass.Play();
guitar.Play();

// Master controls
mixer.MasterVolume = 0.9f;

// Real-time metering
float leftPeak = mixer.LeftPeak;
float rightPeak = mixer.RightPeak;

// Recording
mixer.StartRecording("output.wav");
// ... playback ...
mixer.StopRecording();

// Cleanup
mixer.Stop();
mixer.Dispose();</code></pre>
            </div>

            <h3>Properties</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>MasterVolume</code></td>
                        <td>float</td>
                        <td>Master volume level (0.0-1.0)</td>
                    </tr>
                    <tr>
                        <td><code>IsRunning</code></td>
                        <td>bool</td>
                        <td>True if mixer is running</td>
                    </tr>
                    <tr>
                        <td><code>SourceCount</code></td>
                        <td>int</td>
                        <td>Number of active sources</td>
                    </tr>
                    <tr>
                        <td><code>LeftPeak</code></td>
                        <td>float</td>
                        <td>Left channel peak level</td>
                    </tr>
                    <tr>
                        <td><code>RightPeak</code></td>
                        <td>float</td>
                        <td>Right channel peak level</td>
                    </tr>
                    <tr>
                        <td><code>IsRecording</code></td>
                        <td>bool</td>
                        <td>True if currently recording</td>
                    </tr>
                    <tr>
                        <td><code>MasterClock</code></td>
                        <td>MasterClock</td>
                        <td>Master clock for timeline synchronization</td>
                    </tr>
                </tbody>
            </table>

            <h3>Methods</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Start()</code></td>
                        <td>Start the mixer</td>
                    </tr>
                    <tr>
                        <td><code>Stop()</code></td>
                        <td>Stop the mixer</td>
                    </tr>
                    <tr>
                        <td><code>AddSource(IAudioSource)</code></td>
                        <td>Add audio source to mixer</td>
                    </tr>
                    <tr>
                        <td><code>RemoveSource(Guid)</code></td>
                        <td>Remove source by ID</td>
                    </tr>
                    <tr>
                        <td><code>RemoveAllSources()</code></td>
                        <td>Remove all sources</td>
                    </tr>
                    <tr>
                        <td><code>AddMasterEffect(IEffectProcessor)</code></td>
                        <td>Add effect to master chain</td>
                    </tr>
                    <tr>
                        <td><code>RemoveMasterEffect(IEffectProcessor)</code></td>
                        <td>Remove effect from master chain</td>
                    </tr>
                    <tr>
                        <td><code>StartRecording(string)</code></td>
                        <td>Start recording to WAV file</td>
                    </tr>
                    <tr>
                        <td><code>StopRecording()</code></td>
                        <td>Stop recording</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="effects">Audio Effects</h2>
            <p>OwnaudioNET includes 15+ professional audio effects with preset support.</p>

            <div class="alert alert-info">
                <strong>Complete Effects Documentation</strong>
                For detailed information about all effects, parameters, presets, and usage examples,
                see the dedicated <a href="effects.html" style="color: var(--primary-color); font-weight: 600;">Audio
                    Effects Reference</a>.
            </div>

            <h3>Quick Start - Adding Effects</h3>
            <div class="code-block">
                <div class="code-header">Basic Effect Usage</div>
                <pre><code class="language-csharp">// Create source and wrap with effects capability
var fileSource = new FileSource("audio.mp3");
var source = new SourceWithEffects(fileSource);

// Add effects
var compressor = new CompressorEffect(CompressorPreset.VocalGentle);
var reverb = new ReverbEffect(ReverbPreset.VocalBooth);
var limiter = new LimiterEffect(48000f, LimiterPreset.Mastering);

source.AddEffect(compressor);
source.AddEffect(reverb);
source.AddEffect(limiter);

// Control effects
reverb.Enabled = false;  // Bypass
compressor.Threshold = 0.6f;  // Adjust parameter

// Add to mixer
mixer.AddSource(source);
mixer.Start();</code></pre>
            </div>

            <h3>Available Effects</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Effects</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Dynamics</strong></td>
                        <td>Compressor, Limiter, AutoGain, DynamicAmp</td>
                    </tr>
                    <tr>
                        <td><strong>Frequency</strong></td>
                        <td>Equalizer (10-band), Equalizer30Band, Enhancer</td>
                    </tr>
                    <tr>
                        <td><strong>Modulation</strong></td>
                        <td>Chorus, Flanger, Phaser, Rotary</td>
                    </tr>
                    <tr>
                        <td><strong>Spatial</strong></td>
                        <td>Reverb, Delay</td>
                    </tr>
                    <tr>
                        <td><strong>Distortion</strong></td>
                        <td>Distortion, Overdrive</td>
                    </tr>
                </tbody>
            </table>

            <p style="margin-top: 1.5rem;">
                <strong>See Also:</strong> <a href="effects.html" style="color: var(--primary-color);">Full Effects
                    Documentation</a>
                for detailed parameters, all presets, technical details, and advanced usage examples.
            </p>

            <h2 id="sync">Synchronization</h2>

            <h3>Master Clock Architecture</h3>
            <p>OwnaudioNET uses a professional DAW-style Master Clock for sample-accurate synchronization with timeline
                positioning and automatic drift correction.</p>

            <div class="alert alert-success">
                <strong>Master Clock System (v2.4.0+)</strong>
                Timeline-based synchronization provides sample-accurate sync, start offsets, realtime/offline rendering
                modes, and automatic drift correction.
            </div>

            <div class="code-block">
                <div class="code-header">Master Clock Synchronization</div>
                <pre><code class="language-csharp">// Create sources
var drums = new FileSource("drums.wav");
var bass = new FileSource("bass.wav");
var guitar = new FileSource("guitar.wav");

// Add to mixer
mixer.AddSource(drums);
mixer.AddSource(bass);
mixer.AddSource(guitar);

// Attach sources to Master Clock
drums.AttachToClock(mixer.MasterClock);
bass.AttachToClock(mixer.MasterClock);
guitar.AttachToClock(mixer.MasterClock);

// Optional: Set start offsets (timeline positioning)
drums.StartOffset = 0.0;    // Starts at 0 seconds
bass.StartOffset = 0.0;     // Starts at 0 seconds
guitar.StartOffset = 2.0;   // Starts at 2 seconds (delayed)

// Start mixer
mixer.Start();

// Start all sources for playback (IMPORTANT!)
drums.Play();
bass.Play();
guitar.Play();

// All attached sources now play in perfect sync with Master Clock

// Timeline control
mixer.MasterClock.SeekTo(10.0);  // Seek all tracks to 10 seconds

// Get current timeline position
double currentTime = mixer.MasterClock.CurrentTimestamp;
long samplePosition = mixer.MasterClock.CurrentSamplePosition;

// Rendering modes
mixer.MasterClock.Mode = ClockMode.Realtime;  // Default: dropout ‚Üí silence + event
mixer.MasterClock.Mode = ClockMode.Offline;   // Offline: blocking, deterministic</code></pre>
            </div>

            <h3>Automatic Drift Correction</h3>
            <p>The Master Clock automatically maintains perfect synchronization with sub-10ms drift tolerance.</p>
            <div class="code-block">
                <div class="code-header">Drift Correction</div>
                <pre><code class="language-csharp">// Drift correction is automatic with Master Clock
// Tolerance: 10ms (~480 samples @ 48kHz)
// When drift exceeds tolerance, sources automatically resync

// Monitor dropout events (occurs when sources can't keep up)
mixer.TrackDropout += (sender, e) =>
{
    Console.WriteLine($"Track dropout: {e.TrackName}");
    Console.WriteLine($"  At time: {e.MasterTimestamp:F3}s");
    Console.WriteLine($"  Missed frames: {e.MissedFrames}");
    Console.WriteLine($"  Reason: {e.Reason}");
};</code></pre>
            </div>

            <h3>Timeline Features</h3>
            <div class="code-block">
                <div class="code-header">Timeline and Start Offsets</div>
                <pre><code class="language-csharp">// DAW-style timeline positioning
var intro = new FileSource("intro.wav");
var verse = new FileSource("verse.wav");
var chorus = new FileSource("chorus.wav");

intro.AttachToClock(mixer.MasterClock);
verse.AttachToClock(mixer.MasterClock);
chorus.AttachToClock(mixer.MasterClock);

// Position tracks on timeline
intro.StartOffset = 0.0;      // 0:00
verse.StartOffset = 8.5;      // 0:08.5
chorus.StartOffset = 24.3;    // 0:24.3

mixer.AddSource(intro);
mixer.AddSource(verse);
mixer.AddSource(chorus);

mixer.Start();

// Start all sources
intro.Play();
verse.Play();
chorus.Play();

// Tracks play at their scheduled times based on StartOffset

// Timeline navigation
mixer.MasterClock.SeekTo(20.0);  // Jump to 20 seconds - all tracks sync</code></pre>
            </div>

            <div style="margin-top: 4rem; padding: 2rem; background: var(--surface); border-radius: 8px;">
                <h3>Related Documentation</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.5rem;">
                        <a href="quickstart.html" style="color: var(--primary-color);">üìñ Quick Start Guide</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="api-core.html" style="color: var(--core-color);">üîß Core API Reference</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="effects.html" style="color: var(--primary-color);">üéõÔ∏è Effects Reference</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="examples.html" style="color: var(--primary-color);">üí° Code Examples</a>
                    </li>
                    <li style="margin-bottom: 0.5rem;">
                        <a href="https://github.com/ModernMube/OwnAudioSharp" target="_blank"
                            style="color: var(--primary-color);">üîó GitHub Repository</a>
                    </li>
                </ul>
            </div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="docs.js"></script>
    <script>
        // Active sidebar navigation
        const sections = document.querySelectorAll('h2[id], h3[id]');
        const navLinks = document.querySelectorAll('.sidebar-nav a');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (window.pageYOffset >= sectionTop - 150) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>

</html>